---
title:  "[게임개발] The Fins"
excerpt: "2D전략디펜스 / 유니티 / PROJECT-A 두번째 작품 / 05"

categories:
  - gamedev 
tags:
  - [Unity, GameDev, PROJECT-A]

breadcrumb: true

toc: true

---

<div class="notice--warning" markdown=1>
🕹 타이틀 : Alone  <br>
🕹 장르 : 2D전략디펜스   <br>
🕹 플랫폼 : PC   <br>
🕹 개발기간 : 2019.06 ~ 2019.09   <br>
🕹 개발인원 : 3명 ( <u>프로그래머</u>, 디자이너, 기획자)   <br>
🕹 플레이타임 : 1~2시간  <br>
🕹 사용 툴 : Unity   <br>
 </div>
 
 ---

## 🔸 플레이 영상
{% include video id="Qs8TFyCjqwo" provider="youtube" %}

---

## 🔸 게임 설명 


<p align="left">
	<img src="https://user-images.githubusercontent.com/45874696/148540536-cb560f75-8a55-4b1e-a581-89b7165190ec.png" alt="first" width="300"/>
</p>


*친구의 생일선물 만들어주기 프로젝트*로 만들어진 **PROJECT-A**팀의 두번째 게임입니다.  
`쿼터뷰` 시점의 <u>전략 디펜스게임</u>으로, 해양생물들을 소환하여 사방에서 쏟아져오는 적들로부터 기지를 방어하면서 공격을 뚫고 나아가 적의 기지를 모두 파괴하면 승리합니다. 

'조개'라는 자원을 소모하여 유닛을 아군의 기지 인근의 지정한 위치에 소환할 수 있는데, 소환 이후에는 플레이어가 조작 할 수 없고 단지 Ai에 따라서 이동,공격을 시작합니다. 따라서 <u>어떤 유닛을 어느 위치에 언제 소환하는지</u>가 중요한 전략으로 작용합니다. 소환에 필요한 자원인 '조개'는 시간이 흐르면서 자동 획득하며 R버튼을 통해 1초당 조개 획득량을 업그레이드 할 수 있습니다.


다양한 공략방법을 요구하는 총 10개의 스테이지로 구성되어 있습니다.  




### ◼ 해양생물 유닛

<p align="center">
	<img src="https://user-images.githubusercontent.com/45874696/148519036-af7b29ad-28c6-408f-bd16-d580e234319a.png" alt="first" width="100%"/>
</p>

- 6종류의 아군 유닛이 존재하며 각각 다른 공격방식을 지니고 있습니다. 
- 적 또한 4종류의 유닛이 존재하며 각각 공격방식이 다릅니다.

- 유닛들은 대략적인 상성이 존재하기 때문에 적을 상대할 때 효율적으로 병력을 운용하는것이 핵심입니다.

### ◼ 유닛의 AI
각 유닛은 공통된 **FSM**(finite state machine)에 따라 행동합니다.
- **소환** : 
  - 소환된 유닛은 즉시 가장 가까운 적 기지를 공격 대상으로 지정하고 이동을 개시합니다.
  - 소환 직후에는 공격 재사용 대기시간을 갖습니다.
- **이동** : 
  - 공격 대상을 향해 이동하며 지정된 탐지범위 내에 적 유닛이 들어오면 공격대상을 적 유닛으로 변경하고 대상을 향해 이동경로를 바꿉니다. 유닛의 이동은 `A*길찾기 알고리즘`을 기반으로 하였습니다.
  - 적 유닛이 지정된 공격범위 내에 들어오면, 공격을 개시합니다.
- **공격** : 
  - 공격대상이 공격범위 내에 있다면, 즉시 공격하여 피해를 입힌 후 공격 재사용 대기시간을 갖습니다. 각 유닛별로 재사용 대기시간은 다르며 대기시간이 종료되면 다시 공격합니다. 
  - 공격대상이 살아있는 한 지속하여 공격을 반복합니다. 
  - 공격대상이 사라졌다면 다시 이동 상태로 돌아갑니다. 
- **죽음** :
  - 유닛의 체력이 다하면 죽음 애니메이션과 함께 소멸합니다. 

<br>

<p align="center">
	<img src="https://user-images.githubusercontent.com/45874696/148534374-4084d2a0-84b4-4bc0-8a80-3233a1fbca64.png" alt="first" width="80%"/> <br>
  < 이동경로(<span style="color:green;">초록실선</span>) / 탐지범위(<span style="color:blue;">파란 원</span>) / 공격범위(<span style="color:red;">빨간 원</span>) > 
</p>


<br>

### ◼ 레벨 디자인 툴

<p align="center">
	<img src="https://user-images.githubusercontent.com/45874696/148540217-2f80822a-cef5-4a11-9209-f3bf0f2b250f.png" alt="first" width="400"/>
</p>

유니티의 `custom inspector`를 이용해 스테이지를 제작하는 툴을 만들어 사용하였습니다.  
스테이지 레벨 디자인은 저 뿐만 아니라 디자이너와 기획자 모두 참여했고 수시로 수치를 변경하며 테스트를 해야 했기에 쉽게 레벨을 만들 수 있는 도구가 필요했습니다. 유니티 엔진 내에서 미션 종류부터 웨이브 설정까지 스테이지에 관한 모든 것들 설정할 수 있도록 했습니다. 이 레벨 디자인 툴 덕에 프로그래머가 아니어도 스테이지별로 쉽게 수정 및 테스트가 가능해지면서 개발에 속도가 붙었습니다.
<br>

### ◼ 귀신의 AI

귀신은 특정 스토리 이벤트 이후 미리 세팅된 지점들, 그리고 낮은 확률로 랜덤한 시점에 플레이어 인근의 랜덤한 지점에서 스폰됩니다. 스폰된 이후 귀신은 플레이어를 추적하여 이동합니다. 추적은 유니티의 `navigation`기능을 사용하여 미리 Baked된 맵에 따라서 플레이어를 쫒아갑니다.

플레이어가 안전지대(문에 부적이 깔려있는 방)에 들어가서 귀신이 부적에 닿아 일시 소멸하기 전까지는 끝없이 플레이어를 추적합니다.
<br>

### ◼ 저장 및 불러오기 
게임 내 특정 지점에서 저장을 할 수 있습니다. 저장 및 불러오기는 유니티 에셋스토어의 세이브 관련 에셋 소스를 일부 변형하여 게임에 적용하였습니다. 현재 스토리 이벤트 진행도, 플레이어 위치값, 인벤토리 데이터를 세이브 클래스로 묶어 저장하고, 불러오도록 하였습니다. 
<br>

---

## 🔸 개발 의도
왜 해양생물이 등장하는 게임인가? 라고 한다면, 이 게임을 생일선물로 받을 친구가 해양연구소의 직원이었고 친구와 관련된 내용을 담고 싶었기 때문입니다😁 가장 먼저 테마를 해양생물로 정한 뒤에 디펜스 쪽으로 가닥을 잡았습니다. 기획당시 오토체스나 전략적 팀 전투(TFT)로 대표되는 **오토배틀러**(auto battler)장르가 인기를 끌기 시작할 무렵이라, 이와 비슷하게 전투 전에는 플레이어가 개입하되 전투 자체는 자동으로 진행되는 게임을 만들고자 했습니다.   

디펜스 류의 게임이지만 단순히 막기만 하는것이 아니라, 적 기지까지 파괴를 해야하는 방식을 추가하였고 이것이 전략적인 고민을 하게 만들면서 다른 게임과의 차별점이 되었다고 생각합니다. 

## 🔸 긍정적인 부분
장거리에 있는 사람과 유니티 콜라보레이션 기능을 이용해 `원격으로 협업`하며 서로의 작업물을 합치고 병합하는 경험을 하였습니다. 디자이너는 미국에서, 저는 일본에서 개발을 진행하였습니다. 시차로 인해 실시간으로 의견을 주고받기 어려운 상황에서 `카톡을 이용해 작업기록`을 남기는 방식으로 제작해나갔습니다. 

짧은 시간에 결과물을 내야 했기에, 개발기간을 단축시킬 수 있는 에셋들을 찾아내어 프로젝트에 맞게 적용시키는 경험을 하였습니다. 자연스러운 카메라무빙을 위한 cinemachine, 애니메이션에서는 dotween, 포스트프로세싱과 화면렌더링에선 stylizer, 2d조명시스템을 위한 2d-dynamic-light 등 `다양한 에셋을 프로젝트에 적절히 활용`해서 개발하였습니다.

## 🔸 아쉬웠던 부분
가장 아쉬운 점은 시간 관계상 게임 후반부에 존재하는 몇 가지 버그를 잡지 못하고 프로젝트를 마무리했던 것입니다. 예를 들어 게임 후반부의 스토리 이벤트로 귀신이 등장하는데, 일정 시간 후 사라져야 할 귀신이 특정 상황에서는 사라지지 않고 맵에 남아버려 이후 해당 맵에 재방문했을 때 문제가 발생했었습니다.   

 

  

## 🔸 스크린 샷
 

<p align="center">
	<img src="https://user-images.githubusercontent.com/45874696/67153602-64af6080-f327-11e9-9c2f-8a8619aa9880.png" alt="first" width="400"/>
  <img src="https://user-images.githubusercontent.com/45874696/148509279-7c52d9cc-8ec4-4603-b0f4-6051dacf0ec3.png" alt="second" width="400"/>
  <img src="https://user-images.githubusercontent.com/45874696/148509359-836cee62-f2b8-4787-a845-bf254bed06b7.png" alt="third" width="400"/>
  <img src="https://user-images.githubusercontent.com/45874696/148510272-3b3cbdea-ccc2-4f76-aede-d7d17a99f3ae.png" alt="fourth" width="400"/>
    <img src="https://user-images.githubusercontent.com/45874696/148511788-54c47b45-3d3e-491c-96ea-dd63436b29b9.png" alt="fifth" width="400"/>
  <img src="https://user-images.githubusercontent.com/45874696/148509757-703d931c-2b53-4860-8fd2-a27db9fd3e43.png" alt="sixth" width="400"/>
</p>

<small style ="color:gray;">(post-code: the-fins) </small> 
 {: .text-right}

[TOP](#){: .btn .btn--warning} 
{: .text-right}